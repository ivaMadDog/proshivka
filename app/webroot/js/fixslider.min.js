$.extend($.ui.slider.prototype,{options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,content:[function(){return $(this).attr("data-values-0")},function(){return $(this).attr("data-values-1")}],position:{left:[0,0],top:[15,15]},tooltip:!1,tooltipDisplay:!1,tooltipClass:""},_widthHalfHandle:function(){return Math.round(this.element.find(".ui-slider-handle").width()/2)},_heightHalfHandle:function(){return Math.round(this.element.find(".ui-slider-handle").height()/ 2)},_create:function(){var a=this,b=this.options,c=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),d=b.values&&b.values.length||1,e=[];this.tooltip=[];this._mouseSliding=this._keySliding=!1;this._animateOff=!0;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(b.disabled?" ui-slider-disabled ui-disabled":""));this.range=$([]);b.range&&(!0=== b.range&&(b.values||(b.values=[this._valueMin(),this._valueMin()]),b.values.length&&2!==b.values.length&&(b.values=[b.values[0],b.values[0]])),this.range=$("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+("min"===b.range||"max"===b.range?" ui-slider-range-"+b.range:"")));for(var f=c.length;f<d;f+=1)e.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");this.handles=c.add($(e.join("")).appendTo(a.element));this.handle=this.handles.eq(0); this.handles.add(this.range).filter("a").click(function(a){a.preventDefault()}).hover(function(){b.disabled||$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")}).focus(function(){b.disabled?$(this).blur():($(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),$(this).addClass("ui-state-focus"))}).blur(function(){$(this).removeClass("ui-state-focus")});this.handles.each(function(b){0==b?$(this).addClass("first-handle"):$(this).addClass("second-handle");$(this).data("index.ui-slider-handle", b);a.options.tooltip&&a.element.attr("data-values-"+b,a.options.values[b])});this.handles.keydown(function(b){var c=!0,e=$(this).data("index.ui-slider-handle"),d,f,k;if(!a.options.disabled){switch(b.keyCode){case $.ui.keyCode.HOME:case $.ui.keyCode.END:case $.ui.keyCode.PAGE_UP:case $.ui.keyCode.PAGE_DOWN:case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(c=!1,!a._keySliding&&(a._keySliding=!0,$(this).addClass("ui-state-active"),a.options.tooltipDisplay|| a._tooltipOpen(a.handles[e],e),d=a._start(b,e),!1===d))return}k=a.options.step;d=a.options.values&&a.options.values.length?f=a.values(e):f=a.value();switch(b.keyCode){case $.ui.keyCode.HOME:f=a._valueMin();break;case $.ui.keyCode.END:f=a._valueMax();break;case $.ui.keyCode.PAGE_UP:f=a._trimAlignValue(d+(a._valueMax()-a._valueMin())/numPages);break;case $.ui.keyCode.PAGE_DOWN:f=a._trimAlignValue(d-(a._valueMax()-a._valueMin())/numPages);break;case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:if(d===a._valueMax())return; f=a._trimAlignValue(d+k);break;case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(d===a._valueMin())return;f=a._trimAlignValue(d-k)}a._slide(b,e,f);return c}}).keyup(function(b){var c=$(this).data("index.ui-slider-handle");a._keySliding&&(a._keySliding=!1,a._stop(b,c),a._change(b,c),$(this).removeClass("ui-state-active"),a.options.tooltipDisplay||a._removeTooltip(a.tooltip[a._getHandleIndex($(a.handles[c]))]))});this._refreshValue();this._animateOff=!1;this.options.tooltipDisplay&&(this._tooltipOpen(this.handles[0], 0),this._tooltipOpen(this.handles[1],1))},_refreshValue:function(){var a=this.options.range,b=this.options,c=this,d=!this._animateOff?b.animate:!1,e,f={},g,l,h,j,m="horizontal"===b.orientation?100*c._widthHalfHandle()/c.element.width():100*c._heightHalfHandle()/c.element.height();if(this.options.values&&this.options.values.length)this.handles.each(function(a){e=100*((c.values(a)-c._valueMin())/(c._valueMax()-c._valueMin()));e=0==a?e-m:e+m;f["horizontal"===c.orientation?"left":"bottom"]=e+"%";$(this).stop(1, 1)[d?"animate":"css"](f,b.animate);if(!0===c.options.range)if("horizontal"===c.orientation){if(0===a)c.range.stop(1,1)[d?"animate":"css"]({left:e+"%"},b.animate);if(1===a)c.range[d?"animate":"css"]({width:e-g+"%"},{queue:!1,duration:b.animate})}else{if(0===a)c.range.stop(1,1)[d?"animate":"css"]({bottom:e+"%"},b.animate);if(1===a)c.range[d?"animate":"css"]({height:e-g+"%"},{queue:!1,duration:b.animate})}g=e});else{l=this.value();h=this._valueMin();j=this._valueMax();e=j!==h?100*((l-h)/(j-h)):0;f["horizontal"=== c.orientation?"left":"bottom"]=e+"%";this.handle.stop(1,1)[d?"animate":"css"](f,b.animate);if("min"===a&&"horizontal"===this.orientation)this.range.stop(1,1)[d?"animate":"css"]({width:e+"%"},b.animate);if("max"===a&&"horizontal"===this.orientation)this.range[d?"animate":"css"]({width:100-e+"%"},{queue:!1,duration:b.animate});if("min"===a&&"vertical"===this.orientation)this.range.stop(1,1)[d?"animate":"css"]({height:e+"%"},b.animate);if("max"===a&&"vertical"===this.orientation)this.range[d?"animate": "css"]({height:100-e+"%"},{queue:!1,duration:b.animate})}},_slide:function(a,b,c){var d;if(this.options.values&&this.options.values.length){d=this.values(b?0:1);if(2===this.options.values.length&&!0===this.options.range&&(0===b&&c>d||1===b&&c<d))c=d;c!==this.values(b)&&(d=this.values(),d[b]=c,a=this._trigger("slide",a,{handle:this.handles[b],value:c,values:d}),this.values(b?0:1),!1!==a&&this.values(b,c,!0))}else c!==this.value()&&(a=this._trigger("slide",a,{handle:this.handles[b],value:c}),!1!==a&& this.value(c));this.options.tooltip&&(this.element.attr("data-values-"+b,this.options.values[b]),c=this.options.content[b].call(this.element),this.tooltip[this._getHandleIndex(this.handles[b])].length&&(this.tooltip[this._getHandleIndex(this.handles[b])].find(".ui-tooltip-content").html(c),"horizontal"==this.options.orientation?this.tooltip[this._getHandleIndex(this.handles[b])].css({left:1*$(this.handles[b]).css("left").replace("px","")+this.options.position.left[b]+"px",top:this.options.position.top[b]+ "px",marginLeft:$(this.handles[b]).css("margin-left")}):this.tooltip[this._getHandleIndex(this.handles[b])].css({left:this.options.position.left[b]+"px",top:$(this.handles[b]).position().top+this.options.position.top[b]+"px",marginLeft:$(this.handles[b]).css("margin-left")})))},_normValueFromMouse:function(a){var b;"horizontal"===this.orientation?(b=this.elementSize.width,a=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,a=a.y-this.elementOffset.top- (this._clickOffset?this._clickOffset.top:0));"horizontal"===this.orientation?($(".first-handle").hasClass("ui-state-active")&&(a+=this._widthHalfHandle()),$(".second-handle").hasClass("ui-state-active")&&(a-=this._widthHalfHandle())):($(".first-handle").hasClass("ui-state-active")&&(a-=this._heightHalfHandle()),$(".second-handle").hasClass("ui-state-active")&&(a+=this._heightHalfHandle()));b=a/b;1<b&&(b=1);0>b&&(b=0);"vertical"===this.orientation&&(b=1-b);a=this._valueMax()-this._valueMin();b=this._valueMin()+ b*a;return this._trimAlignValue(b)},_mouseCapture:function(a){var b=this.options,c,d,e,f,g;if(b.disabled)return!1;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();c=this._normValueFromMouse({x:a.pageX,y:a.pageY});d=this._valueMax()-this._valueMin()+1;f=this;this.handles.each(function(a){var b=Math.abs(c-f.values(a));d>b&&(d=b,e=$(this),g=a)});!0===b.range&&this.values(1)===b.min&&(g+=1,e=$(this.handles[g]));this.values(0)== this.values(1)&&$(this.handles[1]).hasClass("ui-state-hover")&&0==g?g=1:this.values(0)==this.values(1)&&($(this.handles[0]).hasClass("ui-state-hover")&&1==g)&&(g=0);e=$(this.handles[g]);if(!1===this._start(a,g))return!1;this._mouseSliding=!0;f._handleIndex=g;e.addClass("ui-state-active").focus();f.options.tooltipDisplay||f._tooltipOpen(this.handles[g],g);b=e.offset();this._clickOffset=!$(a.target).parents().andSelf().is(".ui-slider-handle")?{left:0,top:0}:{left:a.pageX-b.left-e.width()/2,top:a.pageY- b.top-e.height()/2-(parseInt(e.css("borderTopWidth"),10)||0)-(parseInt(e.css("borderBottomWidth"),10)||0)+(parseInt(e.css("marginTop"),10)||0)};this.handles.hasClass("ui-state-hover")||this._slide(a,g,c);return this._animateOff=!0},_mouseStop:function(a){this.handles.removeClass("ui-state-active");this.options.tooltipDisplay||this._removeTooltip(this.tooltip[this._getHandleIndex(this.handles[this._handleIndex])]);this._mouseSliding=!1;this._stop(a,this._handleIndex);this._change(a,this._handleIndex); this._clickOffset=this._handleIndex=null;return this._animateOff=!1},_tooltipOpen:function(a,b){if(!this.options.tooltip)return"";var c="ui-tooltip-"+this._getHandleIndex(a),c=$("<div>").attr({id:c,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));$("<div>").addClass("ui-tooltip-content").appendTo(c);c.css("display","none");c.appendTo(this.element);c.fadeIn("fast");var d=this.options.content[b].call(this.element);c.find(".ui-tooltip-content").html(d); "horizontal"==this.options.orientation?c.css({left:1*$(a).css("left").replace("px","")+this.options.position.left[b]+"px",top:this.options.position.top[b]+"px",marginLeft:$(a).css("margin-left")}):c.css({left:this.options.position.left[b]+"px",top:$(a).position().top+this.options.position.top[b]+"px",marginLeft:$(a).css("margin-left")});this.tooltip[this._getHandleIndex(a)]=c},_removeTooltip:function(a){$(a).length&&a.fadeOut("fast",function(){$(a).remove()})},_getHandleIndex:function(a){return $(".ui-slider-handle").index(a)}});